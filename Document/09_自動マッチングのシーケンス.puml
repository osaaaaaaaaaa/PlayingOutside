@startuml
'https://plantuml.com/sequence-diagram


participant クライアントA
participant クライアントB
participant クライアントC
participant クライアントD
participant サーバー

autonumber
title 自動マッチングのシーケンス図
rnote over クライアントA,クライアントD:現在のシーン：MatchingScene
クライアントA -> サーバー:ロビー入室、ユーザー情報
rnote over サーバー:現在の参加人数が４人いるかチェック
クライアントA <-- サーバー:現在参加しているユーザー情報
rnote over クライアントA:プレイヤーを生成する

クライアントB -> サーバー:ロビー入室、ユーザー情報
rnote over サーバー:現在の参加人数が４人いるかチェック
クライアントA <-- サーバー:クライアントBのユーザー情報
クライアントB <-- サーバー:参加しているユーザー情報
rnote over クライアントA,クライアントB:プレイヤーを生成する

クライアントC -> サーバー:ロビー入室、ユーザー情報
rnote over サーバー:現在の参加人数が4人いるかチェック
クライアントA <-- サーバー:クライアントCのユーザー情報
クライアントB <-- サーバー:クライアントCのユーザー情報
クライアントC <-- サーバー:参加しているユーザー情報
rnote over クライアントA,クライアントC:プレイヤーを生成する

クライアントD -> サーバー:ロビー入室、ユーザー情報
rnote over サーバー:現在の参加人数が4人いるかチェック
クライアントA <-- サーバー:クライアントDのユーザー情報
クライアントB <-- サーバー:クライアントDのユーザー情報
クライアントC <-- サーバー:クライアントDのユーザー情報
rnote over クライアントA,クライアントC:プレイヤーを生成する

rnote over サーバー:ユニークなルーム名を作成
クライアントA <-- サーバー:ルーム名
クライアントB <-- サーバー:ルーム名
クライアントC <-- サーバー:ルーム名
クライアントD <-- サーバー:ルーム名

rnote over サーバー:現在ロビーに参加しているユーザーを\nロビーから強制退室

クライアントD <-- サーバー:参加しているユーザー情報
rnote over クライアントD:プレイヤーを生成する

rnote over クライアントA,クライアントD:シーン遷移 => 現在のシーン:RoomScene
rnote over クライアントA,クライアントD:指定されたルームへ入室処理
クライアントA -> サーバー:準備完了リクエスト
クライアントB -> サーバー:準備完了リクエスト
クライアントC -> サーバー:準備完了リクエスト
クライアントD -> サーバー:準備完了リクエスト
rnote over クライアントA,サーバー:ゲーム開始処理
@enduml